@page "/gcalc/indexation"
@inject Calculations calc
@inject NavigationManager navigationManager

<div class="list-group">
    <a class="list-group-item list-group-item-action" @onclick="@ShowIndex" style="cursor: pointer;">Рассчёт индексации</a>
    <a class="list-group-item list-group-item-action" @onclick="@ShowIndexDiff" style="cursor: pointer;">Рассчёт процента индексации</a>
</div>

@if (Index)
{
    <EditForm Model="@modelIndexation" OnValidSubmit="OnSubmitIndex">
        <DataAnnotationsValidator></DataAnnotationsValidator>
        <ValidationSummary></ValidationSummary>

        <div class="form-group">
            <label for="pB">Цена до</label><br />
            <InputNumber @bind-Value="@modelIndexation.priceBefore" id="pB"></InputNumber>
        </div>
        <div class="form-group">
            <label for="pA">Цена до</label><br />
            <InputNumber @bind-Value="@modelIndexation.priceAfter" id="pA"></InputNumber>
        </div>
        <div class="form-group">
            <label for="q">Цена до</label><br />
            <InputNumber @bind-Value="@modelIndexation.quantity" id="q"></InputNumber>
        </div>
        <br/>
    </EditForm>
}

@if (IndexDiff)
{
    @* <EditForm Model="@modelDiff" OnValidSubmit="OnSubmitDiff">
        <DataAnnotationsValidator></DataAnnotationsValidator>
        <ValidationSummary></ValidationSummary>

        <div class="form-group">
            <label for="fA">Первое значение</label><br />
            <InputNumber @bind-Value="@modelDiff.firstAmount" id="fA"></InputNumber>
        </div>
        <div class="form-group">
            <label for="sA">Второе значение</label><br />
            <InputNumber @bind-Value="@modelDiff.secondAmount" id="sA"></InputNumber>
        </div>
        <div class="form-group">
            <label for="fP">Процент от первого</label><br />
            <InputNumber @bind-Value="@modelDiff.firstPercent" id="fP"></InputNumber>
        </div>
        <div class="form-group">
            <label for="sP">Процент от второго</label><br />
            <InputNumber @bind-Value="@modelDiff.secondPercent" id="sP"></InputNumber>
        </div>
        <br />
        <button class="btn btn-success" type="submit"> Посчитать </button>
        <br />
        <h4 style="margin-top: 5px;">@resDiff.ToString("c", new System.Globalization.CultureInfo("ru-RU"))</h4>
    </EditForm> *@
}
<br />
<button class="btn btn-danger" type="button" @onclick="@Back">
    <i class="oi oi-arrow-thick-left"></i>
    Назад
</button>

@code {
    IndexationModel modelIndexation = new();

    double resIndex;
    double resPercent;

    bool Index = false;
    bool IndexDiff = false;

    public void ShowIndex()
    {
        Index = (Index == false) ? true : false;
    }

    public void ShowIndexDiff()
    {
        IndexDiff = (IndexDiff == false) ? true : false;
    }

    public void OnSubmitIndex()
    {
        resIndex = calc.CalculateIndexation(modelIndexation.priceBefore, modelIndexation.priceAfter, modelIndexation.quantity);
    }

    public void Back()
    {
        navigationManager.NavigateTo("/gcalc");
    }
}
